
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4. Howto SkewT-LogP &#8212; Lecture notes - Meteorology &amp; Climate</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '4. Howto SkewT-LogP';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="3. Thermodynamics (ii) - Moist thermodynamics" href="3.%20Thermodynamics%20%28ii%29.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Lecture notes - Meteorology & Climate</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1.%20Gas%20laws.html">1. Gas laws</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.%20Thermodynamics%20%28i%29.html">2. Thermodynamics (i)</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html">3. Thermodynamics (ii) - Moist thermodynamics</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">4. Howto SkewT-LogP</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2F4. Howto SkewT-LogP.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/4. Howto SkewT-LogP.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>4. Howto SkewT-LogP</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lines-in-the-skew-t-log-p-diagram">The lines in the Skew T-log P diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-meteo-variables">Identifying meteorological variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">1. Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dew-point-temperature">2. Dew Point Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-temperature">3. Potential Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-ratio">4. Mixing Ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saturation-mixing-ratio">5. Saturation mixing ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-humidity-rh">6. Relative Humidity (RH)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moist-adiabatic-parcels-simple-clouds">Moist-adiabatic parcels: Simple clouds</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lifting-condensation-level-lcl">1. Lifting Condensation Level (LCL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equivalent-potential-temperature-and-condensated-water-vapour">2. Equivalent potential temperature and condensated water vapour</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wet-bulb-temperature">3. Wet Bulb Temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-and-convection">Stability and convection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnosing-stability-of-layers">1. Diagnosing stability of layers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#level-of-free-convection-lfc-equilibrium-level-el">2. Level of Free Convection (LFC) &amp; Equilibrium Level (EL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convective-inhibition-cin-and-convective-available-potential-energy-cape">3. Convective Inhibition (CIN) and Convective Available Potential Energy (CAPE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convective-condensation-level">4. Convective condensation level</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lifting-followed-by-latent-heat-release-and-descent">Lifting followed by latent heat release and descent</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="howto-skewt-logp">
<h1>4. Howto SkewT-LogP<a class="headerlink" href="#howto-skewt-logp" title="Link to this heading">#</a></h1>
<p>In this notebook, we will explore all the applications of a Skew-T Log-P diagram that you will need for the final exam.</p>
<div class="admonition-we-will-cover admonition">
<p class="admonition-title">We will cover:</p>
<ol class="arabic simple">
<li><p><a class="reference internal" href="#sec-isolines"><span class="std std-ref">The diagram’s isolines</span></a></p></li>
<li><p><a class="reference internal" href="#sec-meteo-variables"><span class="std std-ref">How to find basic meteorological quantities</span></a></p></li>
<li><p><a class="reference internal" href="#sec-moist-adiabatic"><span class="std std-ref">How to determine moist adiabatic quantities that we use in simple cloud models</span></a></p></li>
<li><p><a class="reference internal" href="#sec-stability"><span class="std std-ref">How to analyse and quantify stability and potential for (moist) convection</span></a></p></li>
<li><p><a class="reference internal" href="#sec-ascent-descent"><span class="std std-ref">How to perform calculations involving lifting, diabatic processes, and subsequent descent</span></a></p></li>
</ol>
</div>
<p>In short, this is the course’s Howto SkewT-logP manual!</p>
<p>The notebook builds on an honours project by Shu Wen Puah; she deserves much of the credit.</p>
<section id="the-lines-in-the-skew-t-log-p-diagram">
<span id="sec-isolines"></span><h2>The lines in the Skew T-log P diagram<a class="headerlink" href="#the-lines-in-the-skew-t-log-p-diagram" title="Link to this heading">#</a></h2>
<p>Let us first cover the spaghetti of lines in the diagram. Open up the code cell below if you wish to see how to define these lines.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to make a basic skew T - log p plot</span>
<span class="k">def</span><span class="w"> </span><span class="nf">plot_basic_skewt</span><span class="p">():</span>
    <span class="c1"># Basic Skew T - log p diagram</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">skew</span> <span class="o">=</span> <span class="n">SkewT</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    
    <span class="c1"># Add dry and moist adiabats</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot_dry_adiabats</span><span class="p">()</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot_moist_adiabats</span><span class="p">()</span>
    
    <span class="c1"># Add isohumes at specified mixing ratios</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.026</span><span class="p">,</span> <span class="mf">0.022</span><span class="p">,</span> <span class="mf">0.016</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">])[:,</span> <span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;g/g&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot_mixing_lines</span><span class="p">(</span><span class="n">mixing_ratio</span><span class="o">=</span><span class="n">w</span><span class="p">,</span> <span class="n">pressure</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkseagreen&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">)</span>

    <span class="c1"># Label the isohumes</span>
    <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">w</span><span class="o">.</span><span class="n">flatten</span><span class="p">():</span>
        <span class="n">top_p</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dewpt</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">top_p</span><span class="p">,</span> <span class="n">val</span><span class="p">))</span>
        <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">dewpt</span><span class="p">,</span> <span class="n">top_p</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">val</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span><span class="p">)),</span>
                     <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    
    <span class="c1"># Add a secondary y-axis using the standard atmosphere, so we can see height as well as pressure</span>
    <span class="n">secax</span> <span class="o">=</span> <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">secondary_yaxis</span><span class="p">(</span><span class="o">-</span><span class="mf">0.2</span><span class="p">,</span>
        <span class="n">functions</span><span class="o">=</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">p</span><span class="p">:</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">pressure_to_height_std</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;km&#39;</span><span class="p">),</span>
            <span class="k">lambda</span> <span class="n">h</span><span class="p">:</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">height_to_pressure_std</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">m</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="n">secax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">FixedLocator</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">15</span><span class="p">]))</span>
    <span class="n">secax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_minor_locator</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">NullLocator</span><span class="p">())</span>
    <span class="n">secax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">plt</span><span class="o">.</span><span class="n">ScalarFormatter</span><span class="p">())</span>

    <span class="c1"># Add labels</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature [C]&#39;</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pressure [hPa]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Skew-T Log-P Diagram&#39;</span><span class="p">)</span>
    <span class="n">secax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Height (km)&#39;</span><span class="p">)</span>

    <span class="c1"># Make it big</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">skew</span>

<span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Highlight specific lines</span>
<span class="c1"># Isotherm</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.77</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Isotherm&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Isobar</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Isobar&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Dry adiabat</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span>
<span class="n">T_dry</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degC</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_dry</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.07</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Dry Adiabat&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">60</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="c1"># Moist adiabat</span>
<span class="n">T_moist</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">moist_lapse</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">degC</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_moist</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.22</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Moist Adiabat&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=-</span><span class="mi">55</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1"># Isohume</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">highlight_w</span> <span class="o">=</span> <span class="mf">0.002</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;g/g&#39;</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">highlight_w</span><span class="p">)</span>  
<span class="n">T_mixing</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">T_mixing</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.39</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;Isohume&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                 <span class="n">transform</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">55</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6bb9a1cce983d705b9eec70bc7734ba3c12339f40612acb6a0156adc449f6d9c.png" src="_images/6bb9a1cce983d705b9eec70bc7734ba3c12339f40612acb6a0156adc449f6d9c.png" />
</div>
</div>
<p>We have plotted:</p>
<ol class="arabic simple">
<li><p>Isobars: The horizontal lines with constant pressure.</p></li>
<li><p>Isotherms: The grey, “skewed” grid-lines (set to rise up and right at a 45 degree angle), with equal temperature.</p></li>
<li><p>Dry Adiabats:  The red curved lines with constant potential temperature <span class="math notranslate nohighlight">\(\theta\)</span> (see <a class="reference internal" href="2.%20Thermodynamics%20%28i%29.html"><span class="std std-doc">Thermodynamics (i)</span></a>). They represent the temperatures of dry air parcels lifted or lowered adiabatically to the 1000 hPa level.</p></li>
<li><p>Moist Adiabats: The blue curved lines with constant equivalent potential temperature <span class="math notranslate nohighlight">\(\theta_e\)</span>, with a mixing ratio <span class="math notranslate nohighlight">\(r_v\)</span> kept equal to the saturation mixing ratio (<span class="math notranslate nohighlight">\(r_s\)</span>) at a given pressure and temperature (see <a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html"><span class="std std-doc">Thermodynamics (ii)</span></a>).</p></li>
<li><p>Isohumes: The green, “skewed” lines rising up and right (but more vertically than the isotherm), with constant mixing ratio <span class="math notranslate nohighlight">\(r_v\)</span>. The lines really show the dew-point temperature of a parcel with a prescribed mixing ratio, as the pressure drops (see <a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html"><span class="std std-doc">Thermodynamics (ii)</span></a>).</p></li>
</ol>
</section>
<section id="sec-meteo-variables">
<span id="identifying-meteorological-variables"></span><h2>Identifying meteorological variables<a class="headerlink" href="#sec-meteo-variables" title="Link to this heading">#</a></h2>
<p>We now add a sounding to the diagram, and start by reading off some basic variables, at a selected pressure level.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open a sounding</span>
<span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;data/valencia.nc&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">latitude</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">longitude</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">valid_time</span><span class="o">=</span><span class="s1">&#39;2024-10-29T15:00:00.000000000&#39;</span><span class="p">)</span>

<span class="n">Rd</span> <span class="o">=</span> <span class="mf">287.05</span>
<span class="n">Rv</span> <span class="o">=</span> <span class="mf">461.5</span> <span class="c1"># J/kg/K, gas constant of water</span>
<span class="n">lv_trip</span> <span class="o">=</span> <span class="mf">2500e3</span> <span class="c1"># J/kg, latent heat of vaporisation at the triple point of water</span>
<span class="n">T_trip</span> <span class="o">=</span> <span class="mf">273.15</span> <span class="c1"># K, Temperature for triple point of water at 1000 hPa air pressure</span>
<span class="n">es_trip</span> <span class="o">=</span> <span class="mf">610.94</span> <span class="c1"># Pa, equilibrium vapour pressure at triple point of water</span>

<span class="k">def</span><span class="w"> </span><span class="nf">Tdew</span><span class="p">(</span><span class="n">e</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">T_trip</span> <span class="o">-</span> <span class="n">Rv</span><span class="o">/</span><span class="n">lv_trip</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="n">es_trip</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">e_sq</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">qs</span> <span class="o">*</span> <span class="n">p</span> <span class="o">/</span> <span class="p">(</span><span class="n">qs</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">Rd</span><span class="o">/</span><span class="n">Rv</span><span class="p">)</span> <span class="o">+</span> <span class="n">Rd</span><span class="o">/</span><span class="n">Rv</span><span class="p">)</span>


<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tdew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">q</span><span class="p">))</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tdew&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Tdew</span><span class="p">(</span><span class="n">e_sq</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">q</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span>

<span class="c1"># To increase the width at the bottom of the original soundings for construction visualisation.</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">]</span> <span class="o">+=</span> <span class="mf">1.5</span>
<span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tdew&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&gt;</span> <span class="mi">900</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="temperature">
<h3>1. Temperature<a class="headerlink" href="#temperature" title="Link to this heading">#</a></h3>
<p>Let us first find the temperature in the atmosphere at 700hPa. To do that, take the following steps:</p>
<ol class="arabic simple">
<li><p>Draw a horizontal line at 700 hPa. Find its intersection with the temperature sounding.</p></li>
<li><p>Draw a line parallel to the skewed isotherms from point 1 back down to the x-axis. Read off the temperature: It is 1.8°C.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Draw the horizontal line at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Get the temperature sounding data</span>
<span class="n">temp_sounding</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>  
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span>  

<span class="c1"># Ensure pressure levels are sorted in descending order </span>
<span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pressure_sorted</span> <span class="o">=</span> <span class="n">pressure_levels</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>
<span class="n">temp_sorted</span> <span class="o">=</span> <span class="n">temp_sounding</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>

<span class="c1"># Step 1: Find the two surrounding points for 700 hPa</span>
<span class="n">above_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&gt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Last index where pressure &gt; 700</span>
<span class="n">below_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First index where pressure &lt; 700</span>

<span class="n">p1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">],</span> <span class="n">temp_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">]</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">],</span> <span class="n">temp_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">]</span>

<span class="c1"># Step 2: Linear interpolation to find dew point at 700 hPa</span>
<span class="n">intersection_temp</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">700</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">p1</span><span class="p">))</span>

<span class="c1"># Step 3: Draw a vertical line following the isotherm down to the x-axis </span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">intersection_temp</span><span class="p">,</span> <span class="n">intersection_temp</span><span class="p">],</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> 
             <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 4: Label the temperature found at the intersection</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">intersection_temp</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">intersection_temp</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">°C&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Mark the intersection point at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intersection_temp</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.8</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">970</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/5be7f6582ea8e8ee830ee947ebeba78b7bd2c2dd4ffeed57c6b4670d46cb59f5.png" src="_images/5be7f6582ea8e8ee830ee947ebeba78b7bd2c2dd4ffeed57c6b4670d46cb59f5.png" />
</div>
</div>
</section>
<section id="dew-point-temperature">
<h3>2. Dew Point Temperature<a class="headerlink" href="#dew-point-temperature" title="Link to this heading">#</a></h3>
<p>Let us next determine the dew point temperature at 700hPa:</p>
<ol class="arabic simple">
<li><p>Draw a horizontal line at 700 hPa. Find its intersection with the <em>dew point temperature</em> sounding.</p></li>
<li><p>Draw a line parallel to the skewed isotherms from point 1. back down to the x-axis. Read off the temperature: It is -1.0°C.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Draw the horizontal line at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Get the temperature sounding data</span>
<span class="n">dew_point_sounding</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">tdew</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>  
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span>  

<span class="c1"># Ensure pressure levels are sorted in descending order (high to low)</span>
<span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pressure_sorted</span> <span class="o">=</span> <span class="n">pressure_levels</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>
<span class="n">dew_point_sorted</span> <span class="o">=</span> <span class="n">dew_point_sounding</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>

<span class="c1"># Step 1: Find the two surrounding points for 700 hPa</span>
<span class="n">above_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&gt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  
<span class="n">below_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  

<span class="n">p1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">],</span> <span class="n">dew_point_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">]</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">],</span> <span class="n">dew_point_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">]</span>

<span class="c1"># Step 2: Linear interpolation to find dew point at 700 hPa</span>
<span class="n">intersection_dew_point</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">700</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">p1</span><span class="p">))</span>

<span class="c1"># Step 3: Draw a vertical line following the isotherm (constant temperature) down to the x-axis (1000 hPa)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">intersection_dew_point</span><span class="p">,</span> <span class="n">intersection_dew_point</span><span class="p">],</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> 
             <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 4: Label the temperature found at the intersection</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">intersection_dew_point</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">intersection_dew_point</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">°C&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Mark the intersection point at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intersection_dew_point</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">970</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/b0f843f048b676710a66ba0efd80ef974e343685e2a8e91d2cc3bd84f9a47abe.png" src="_images/b0f843f048b676710a66ba0efd80ef974e343685e2a8e91d2cc3bd84f9a47abe.png" />
</div>
</div>
</section>
<section id="potential-temperature">
<h3>3. Potential Temperature<a class="headerlink" href="#potential-temperature" title="Link to this heading">#</a></h3>
<p>The potential temperature of an air parcel is the temperature that it would have if it were dry, and compressed (or expanded) adiabatically from its current pressure and temperature to a standard pressure (1000hPa). Since this is exactly what moving along a dry adiabat represents, we simply have to:</p>
<ol class="arabic simple">
<li><p>Again draw a horizontal line at 700 hPa and find its intersection with the temperature sounding.</p></li>
<li><p>Draw a line of constant potential temperature (equivalently, a dry adiabat) through this intersection, and follow it down to the 1000 hPa standard pressure.</p></li>
<li><p>Follow the isotherm from this point, to the x-axis, and read off the value: 31.2°C.</p></li>
</ol>
<p>Note that this value is much larger than the temperature at 700 hPa (which was 1.8°C), because compressing the air parcel from 700 hPa to 1000 hPa warms it up substantially.</p>
<p>Because intersection points we want to know the potential temperature at hardly ever line up perfectly with a provided dry adiabat, you will have to draw as parallel to the dry adiabats on the diagram as you can. We won’t penalise drawing errors here, so long as it is clear you are following the right procedure.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Draw the horizontal line at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Get the temperature at 700 hPa and convert to °C</span>
<span class="n">temp_700</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">700</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Plot the point at the intersection</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp_700</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Draw a dry adiabat from the intersection to the x-axis</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_700</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">))</span>  <span class="c1"># Convert back to K for calculation</span>
<span class="n">dry_adiabat_celsius</span> <span class="o">=</span> <span class="n">dry_adiabat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dry_adiabat_celsius</span><span class="p">,</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Label the potential temperature at 700 hPa</span>
<span class="n">theta_700</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">potential_temperature</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
                                         <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_700</span> <span class="o">+</span> <span class="mf">273.15</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">dry_adiabat_celsius</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;θ = </span><span class="si">{</span><span class="n">theta_700</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">°C&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">31.2</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ec58a5ddd2dc6cdcf0e0b0c355b6a0031b1a57a3eca4d5dc156cba1ec3f26f21.png" src="_images/ec58a5ddd2dc6cdcf0e0b0c355b6a0031b1a57a3eca4d5dc156cba1ec3f26f21.png" />
</div>
</div>
</section>
<section id="mixing-ratio">
<span id="sec-mixing-ratio"></span><h3>4. Mixing Ratio<a class="headerlink" href="#mixing-ratio" title="Link to this heading">#</a></h3>
<p>Let us next find the mixing ratio of the sounding at 700 hPa. We essentially measure mixing ratio in a SkewT-logP plot with the dew-point temperature. This is because, at a given pressure <span class="math notranslate nohighlight">\(p\)</span> and dew-point temperature <span class="math notranslate nohighlight">\(T_d\)</span> (i.e. a coordinate point on the diagram), we can determine the mixing ratio, since (see <a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html"><span class="std std-doc">Thermodynamics (ii)</span></a> for origin of the equations):</p>
<ol class="arabic simple">
<li><p>We can solve an approximation of the integrated Clausius-Clapeyron equation (e.g. Tetens’ formula) using the known <span class="math notranslate nohighlight">\(T_d\)</span>, which will give us the equilibrium (or saturation) vapour pressure <span class="math notranslate nohighlight">\(e_s\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
  e_s(T_d) = 610.94 \times \exp\left(17.625\times\frac{T_d - 273.15}{T_d - 30.11}\right)
\]</div>
<ol class="arabic simple" start="2">
<li><p>At saturation, by definition the saturation vapour <span class="math notranslate nohighlight">\(e_s\)</span> pressure equals the actual vapour pressure <span class="math notranslate nohighlight">\(e\)</span>, so we actually know also this vapour pressure.</p></li>
<li><p>We can relate the vapour pressure to the mixing ratio <span class="math notranslate nohighlight">\(r_v\)</span>, with the known pressure <span class="math notranslate nohighlight">\(p\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
r_v = \frac{R_d}{R_v}\frac{e}{p - e}.
\]</div>
<p>In this last equation, if we plug in the expression <span class="math notranslate nohighlight">\(e_s(T_d)\)</span> and solve it for <span class="math notranslate nohighlight">\(p\)</span>, we get an expression for <span class="math notranslate nohighlight">\(p\)</span> only in terms of <span class="math notranslate nohighlight">\(T_d\)</span> and <span class="math notranslate nohighlight">\(r_v\)</span>. So for a fixed <span class="math notranslate nohighlight">\(r_v\)</span>, we can trace lines through the skewT-logP diagram: The isohumes are exactly these lines. It may feel a bit convoluted to express a mixing ratio in terms of a dew-point temperature like this. But it has the advantage of enabling us to plot that mixing ratio in a diagram whose axes are pressure and temperature, so it turns out to be very useful! E.g., to find out the mixing ratio of the sounding at any pressure, all we have to do is intersect the dew-point temperature of the sounding with an isohume, and read off the mixing ratio that is constant along that isohume (this mixing ratio will always be written out on the plot). I.e., the saturation mixing ratio at 700 hPa is determined as follows:</p>
<ol class="arabic simple">
<li><p>Draw a horizontal line at 700 hPa. Find its intersection with the dew point temperature sounding.</p></li>
<li><p>Draw a line parallel to the isohume from this intersection. Read off the saturation mixing ratio. You may need to mentally interpolate between adjacent lines; we will not penalise you for slightly wrong answers here, so long as you follow the right procedure.</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Draw the horizontal line at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 1: Find the intersection between the dew point temperature sounding and the 700 hPa isobar</span>
<span class="c1"># Get the dew point temperature sounding data</span>
<span class="n">dewpoint_sounding</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">tdew</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Convert to Celsius</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Pressure levels in hPa</span>

<span class="c1"># Ensure pressure levels are sorted in descending order</span>
<span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pressure_sorted</span> <span class="o">=</span> <span class="n">pressure_levels</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>
<span class="n">dewpoint_sorted</span> <span class="o">=</span> <span class="n">dewpoint_sounding</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>

<span class="c1"># Find the two surrounding points for 700 hPa</span>
<span class="n">above_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&gt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Last index where pressure &gt; 700</span>
<span class="n">below_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First index where pressure &lt; 700</span>

<span class="n">p1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">],</span> <span class="n">dewpoint_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">]</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">],</span> <span class="n">dewpoint_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">]</span>

<span class="c1"># Linear interpolation to find the dew point temperature at 700 hPa</span>
<span class="n">intersection_dew_point</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">700</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">p1</span><span class="p">))</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 700 hPa</span>
<span class="n">e_sat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">intersection_dew_point</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>
<span class="n">mixing_ratio_value</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e_sat</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Step 3: Find the dew point temperature at 500 hPa with the same mixing ratio</span>
<span class="n">e_500</span> <span class="o">=</span> <span class="n">mixing_ratio_value</span> <span class="o">*</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.622</span> <span class="o">+</span> <span class="n">mixing_ratio_value</span><span class="p">)</span>
<span class="n">dewpoint_500</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e_500</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

<span class="c1"># Step 4: Draw the parallel mixing ratio line from 700 hPa to 500 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">intersection_dew_point</span><span class="p">,</span> <span class="n">dewpoint_500</span><span class="p">],</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> 
             <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Mixing Ratio Line&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Label the mixing ratio at 500 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">dewpoint_500</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">mixing_ratio_value</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;g/kg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> g/kg&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 6: Mark the intersection point at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intersection_dew_point</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/5b6d22a1700be151be24c00b8b9d8a9d4b3daa130d52e11710fa4bcc479bfbc5.png" src="_images/5b6d22a1700be151be24c00b8b9d8a9d4b3daa130d52e11710fa4bcc479bfbc5.png" />
</div>
</div>
</section>
<section id="saturation-mixing-ratio">
<h3>5. Saturation mixing ratio<a class="headerlink" href="#saturation-mixing-ratio" title="Link to this heading">#</a></h3>
<p>To calculate the saturation mixing ratio, we can follow a very similar procedure as above. However, since we are asking for the mixing ratio at which the air parcel saturates, not the mixing ratio it contains, we have to insert the <em>temperature</em>, rather than the dew-point temperature, in Tetens’ formula. On the skewT-logP diagram, this is equivalent to intersecting the <em>temperature sounding</em> with an isohume. In this case, the isohume then represents not the mixing ratio, but the saturation mixing ratio of the air at that height. So, we can determine the saturation mixing ratio at 700 hPa as follows:</p>
<ol class="arabic simple">
<li><p>Draw a horizontal line at 700 hPa. Find its intersection with the temperature sounding.</p></li>
<li><p>Draw a line parallel to the isohume. Read off the mixing ratio. In this case, it is 6.3 g/kg.</p></li>
</ol>
<p>From the previous two examples, you see that we can use the isohumes both as lines of constant mixing ratio, or of constant saturation mixing ratio, depending on whether we read off a dew-point temperature, or a temperature. Therefore, you can sometimes see them named “saturated mixing ratio” lines as well as “mixing ratio lines”. You now know that these meanings only become clear once you choose to intersect them with a dew-point temperature (mixing ratio) or temperature (saturation mixing ratio) sounding.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Draw the horizontal line at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 1: Find the intersection between the temperature sounding and the 700 hPa isobar</span>
<span class="c1"># Get the temperature sounding data</span>
<span class="n">temp_sounding</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span> <span class="o">-</span> <span class="mf">273.15</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Convert to Celsius</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Pressure levels in hPa</span>

<span class="c1"># Ensure pressure levels are sorted in descending order</span>
<span class="n">sorted_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">pressure_sorted</span> <span class="o">=</span> <span class="n">pressure_levels</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>
<span class="n">temp_sorted</span> <span class="o">=</span> <span class="n">temp_sounding</span><span class="p">[</span><span class="n">sorted_indices</span><span class="p">]</span>

<span class="c1"># Find the two surrounding points for 700 hPa</span>
<span class="n">above_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&gt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># Last index where pressure &gt; 700</span>
<span class="n">below_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">pressure_sorted</span> <span class="o">&lt;</span> <span class="mi">700</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># First index where pressure &lt; 700</span>

<span class="n">p1</span><span class="p">,</span> <span class="n">t1</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">],</span> <span class="n">temp_sorted</span><span class="p">[</span><span class="n">above_idx</span><span class="p">]</span>
<span class="n">p2</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">pressure_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">],</span> <span class="n">temp_sorted</span><span class="p">[</span><span class="n">below_idx</span><span class="p">]</span>

<span class="c1"># Linear interpolation to find the temperature at 700 hPa</span>
<span class="n">intersection_temp</span> <span class="o">=</span> <span class="n">t1</span> <span class="o">+</span> <span class="p">(</span><span class="n">t2</span> <span class="o">-</span> <span class="n">t1</span><span class="p">)</span> <span class="o">*</span> <span class="p">((</span><span class="mi">700</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">p2</span> <span class="o">-</span> <span class="n">p1</span><span class="p">))</span>

<span class="c1"># Step 2: Calculate the saturation mixing ratio at 700 hPa</span>
<span class="n">e_sat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">intersection_temp</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>
<span class="n">saturation_mixing_ratio_value</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e_sat</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Step 3: To draw an isohume to 500 hPa, find the dew-point temperature at 500 hPa</span>
<span class="c1"># with the same mixing ratio</span>
<span class="n">e_500</span> <span class="o">=</span> <span class="n">saturation_mixing_ratio_value</span> <span class="o">*</span> <span class="mi">500</span> <span class="o">*</span> <span class="n">units</span><span class="o">.</span><span class="n">hPa</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.622</span> <span class="o">+</span> <span class="n">saturation_mixing_ratio_value</span><span class="p">)</span>
<span class="n">dewpoint_500</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e_500</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">m</span>

<span class="c1"># Step 4: Draw the parallel mixing ratio line from 700 hPa to 500 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">intersection_temp</span><span class="p">,</span> <span class="n">dewpoint_500</span><span class="p">],</span> <span class="p">[</span><span class="mi">700</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> 
             <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Saturated Mixing Ratio Line&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Label the mixing ratio at 500 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">dewpoint_500</span><span class="p">,</span> <span class="mi">490</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">saturation_mixing_ratio_value</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;g/kg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1"> g/kg&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 6: Mark the intersection point at 700 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">intersection_temp</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">670</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/9224f0f0784154d8b5f6003f71d2b94b8305f79048e23dfd988f2599d3611b2e.png" src="_images/9224f0f0784154d8b5f6003f71d2b94b8305f79048e23dfd988f2599d3611b2e.png" />
</div>
</div>
</section>
<section id="relative-humidity-rh">
<h3>6. Relative Humidity (RH)<a class="headerlink" href="#relative-humidity-rh" title="Link to this heading">#</a></h3>
<p>Since relative humidity (RH) is the ratio (expressed as a percentage) of the actual mixing ratio <span class="math notranslate nohighlight">\(r_v\)</span> to the saturation mixing ratio <span class="math notranslate nohighlight">\(r_s\)</span> (with respect to a plane surface of pure water at the same temperature and pressure),</p>
<div class="math notranslate nohighlight">
\[
RH = \frac{r_v}{r_s} \times 100
\]</div>
<p>we can determine it for a single air parcel, at a given pressure, from the previous two calculations. For this sounding, at the 700 hPa level, it is therefore <span class="math notranslate nohighlight">\(5.1/6.3\times100=81\%\)</span>.</p>
</section>
</section>
<section id="moist-adiabatic-parcels-simple-clouds">
<span id="sec-moist-adiabatic"></span><h2>Moist-adiabatic parcels: Simple clouds<a class="headerlink" href="#moist-adiabatic-parcels-simple-clouds" title="Link to this heading">#</a></h2>
<section id="lifting-condensation-level-lcl">
<h3>1. Lifting Condensation Level (LCL)<a class="headerlink" href="#lifting-condensation-level-lcl" title="Link to this heading">#</a></h3>
<p>The lifting condensation level (LCL) is defined as the level to which an unsaturated (but moist) parcel of air can be lifted adiabatically before it becomes saturated with respect to a plane surface of pure water. We can almost always find such a height, because if you don’t change the mixing ratio of a parcel, but keep on cooling it by adiabatic expansion, you will find a pressure level where the parcel’s dew-point will equal its actual temperature, and it becomes saturated.</p>
<p>The height of the LCL is often used interchangeably with the cloud base height, although this is only true if the clouds actually consist of parcels which are lifted adiabatically from a certain height. In reality, lifting to the LCL will not always lead to actual clouds, because parcels only rise when they are positively buoyant or otherwise forced upwards, never rise completely adiabatically, but mix with their surroundings, and don’t begin condensating exactly where they become supersaturated (we will study all this further in the clouds module). Nevertheless, for positively buoyant parcels, i.e. for “convective clouds” such as shallow cumuli or deep convective thunderstorms, the LCL of the parcel with the dew-point temperature and temperature from near the surface is often a pretty decent first cloud base model.</p>
<p>The LCL of the surface parcel can be found in the diagram below as follows:</p>
<ol class="arabic simple">
<li><p>Draw a mixing ratio line through the surface dew point temperature. This line represents lifting the parcel while keeping its mixing ratio constant.</p></li>
<li><p>Draw a dry adiabat through the surface temperature. This line represents lifing the parcel and expanding it adiabatically so that its potential tempreature is conserved.</p></li>
<li><p>The intersection of these lines is the LCL.</p></li>
</ol>
<p>The LCL of other parcels in the sounding, lifted from other pressures, can be found by similar constructions.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">dry_adiabat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Find LCL</span>
<span class="n">lcl</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># label the pressure</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">940</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;LCL = 939 hPa&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/5f33a91cddf6a41968111ff15990cae91c8f04dca4a09b2e56b61de2ee2cde3e.png" src="_images/5f33a91cddf6a41968111ff15990cae91c8f04dca4a09b2e56b61de2ee2cde3e.png" />
</div>
</div>
</section>
<section id="equivalent-potential-temperature-and-condensated-water-vapour">
<span id="subsec-equiv-pot"></span><h3>2. Equivalent potential temperature and condensated water vapour<a class="headerlink" href="#equivalent-potential-temperature-and-condensated-water-vapour" title="Link to this heading">#</a></h3>
<p>As we derived in <a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html"><span class="std std-doc">Thermodynamics (ii)</span></a>, the equivalent potential temperature <span class="math notranslate nohighlight">\(\theta_e\)</span> (in case of only liquid-vapour phase transformations) is the potential temperature of an air parcel after all water vapour in it has condensated and released its latent heat:</p>
<div class="math notranslate nohighlight">
\[
\theta_e = \theta\exp\left(\frac{L_vr_v}{c_{p_m}T}\right)
\]</div>
<p><span class="math notranslate nohighlight">\(\theta_e\)</span> can be considerably larger than <span class="math notranslate nohighlight">\(\theta\)</span>, because the temperature rise from the latent heat release (i.e. the term <span class="math notranslate nohighlight">\(\exp\left(\frac{L_vr_v}{c_{p_m}T}\right)\)</span>) can be quite large. To determine <span class="math notranslate nohighlight">\(\theta_e\)</span> on a skewT-logP diagram, we must carry out a rather convoluted lifting operation. However, this operation has the additional benefit of showing how to calculate the amount of water vapour that has been condensated; that is to determine the mixing ratio of liquid water, assuming none of the condensate rains out or freezes:</p>
<ol class="arabic simple">
<li><p>Draw a mixing ratio line from the dew-point temperature of interest</p></li>
<li><p>Draw a dry adiabat from the temperature of interest, and diagnose the LCL at the intersection with line 1.</p></li>
<li><p>Follow the saturated adiabat from the LCL presssure and temperature, to a pressure where the saturated adiabat and dry adiabat are virtually indistinguishable, e.g. 200 hPa.</p></li>
<li><p>Follow a dry adiabat down to 1000 hPa, and read off the temperature: <span class="math notranslate nohighlight">\(\theta_e = 52.5^{\text{o}}\)</span>C.</p></li>
</ol>
<p>The trick in step 3 is to lift the parcel along a line of constant <span class="math notranslate nohighlight">\(\theta_e\)</span> from its LCL. Along this moist adiabat, the parcel is kept at saturation (i.e. <span class="math notranslate nohighlight">\(r_v=r_s\)</span> in the equation above), which is why the line is also sometimes called the “saturated adiabat”. If one then lifts the parcel high enough at saturation, the temperature of the parcel is so low that <span class="math notranslate nohighlight">\(r_s \rightarrow 0\)</span>, i.e. virtually all the water vapour must have condensated into liquid water. In the plot below, we choose 200 hPa. To show this explicitly, we have included another isohume which intersects the parcel at the 200 hPa level – it has a mixing ratio of only <span class="math notranslate nohighlight">\(0.02\)</span> g/kg, i.e. of the original roughly <span class="math notranslate nohighlight">\(11\)</span> g/kg water vapour in the parcel (you can read this off the diagram following the procedure outlined in the <a class="reference internal" href="#sec-mixing-ratio"><span class="std std-ref">mixing ratio section</span></a>), <span class="math notranslate nohighlight">\(11-0.02=10.98\)</span> g/kg has condensated. Therefore, as the equation above shows, at 200 hPa, <span class="math notranslate nohighlight">\(\theta_e \approx \theta\)</span>, and simply following the dry adiabat back down to 1000 hPa allows us to read off this value for <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>To calculate the condensated water vapour of a parcel above the LCL, one can always follow the approach we took in passing above: If you intersect an isohume with a saturated adiabat at the level of interest, this will tell you the <span class="math notranslate nohighlight">\(r_v\)</span> in the parcel at that level, because along a saturated adiabat the parcel is kept at saturation, and so at any pressure <span class="math notranslate nohighlight">\(p\)</span> above the LCL, <span class="math notranslate nohighlight">\(r_{v,p}=r_{s,p}\)</span>. Before the parcel reached the LCL, its <span class="math notranslate nohighlight">\(r_v\)</span> is that of the isohume that you lifted it along to reach the LCL (<span class="math notranslate nohighlight">\(r_{v,0}\)</span>), i.e. the condensated water vapour must be equal to <span class="math notranslate nohighlight">\(r_{s,p} - r_{v,0}\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">60</span><span class="p">)</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">dry_adiabat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Calculate wet-bulb temperature at the surface (1000 hPa)</span>
<span class="n">wet_bulb</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">wet_bulb_temperature</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>  <span class="c1"># Surface pressure</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>                 <span class="c1"># Surface temperature</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>               <span class="c1"># Surface dewpoint temperature</span>
<span class="p">)</span>

<span class="c1"># Step 4: Calculate the LCL (Lifted Condensation Level)</span>
<span class="n">lcl_pressure</span><span class="p">,</span> <span class="n">lcl_temperature</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>  <span class="c1"># Surface pressure</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>                 <span class="c1"># Surface temperature</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>               <span class="c1"># Surface dewpoint temperature</span>
<span class="p">)</span>

<span class="c1">#  Step 5 :Calculate the moist adiabat from the LCL to 200 hPa</span>
<span class="n">moist_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">moist_lapse</span><span class="p">(</span>
    <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lcl_pressure</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
    <span class="n">lcl_temperature</span>
<span class="p">)</span>

<span class="c1"># Plot the moist adiabat from the LCL to 200 hPa</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lcl_pressure</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">moist_adiabat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1">#  Step 6: Calculate the dry adiabat from 200 hPa to the surface</span>
<span class="n">potential_temperature</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">potential_temperature</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">moist_adiabat</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span>
    <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
    <span class="n">potential_temperature</span><span class="p">,</span>
    <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot the dry adiabat from 200 hPa to the surface</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">dry_adiabat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span>
<span class="p">)</span>

<span class="c1"># Print the this potential temperature</span>
<span class="c1"># potential_temperature_celsius = potential_temperature.metpy.convert_units(&#39;degC&#39;).item()</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">potential_temperature</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>


<span class="c1"># Add a mixing ratio line to illustrate how dry the parcel is at 200 hPa</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="mf">2e-5</span><span class="p">))</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">[:</span><span class="mi">24</span><span class="p">],</span> <span class="n">constant_mixing_ratio_line</span><span class="p">[:</span><span class="mi">24</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="s1">&#39;0.02&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">70</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/f5c86f831e0259441a3c8d89e076785cfe03f3bf16e88adf91395d31257b1f2e.png" src="_images/f5c86f831e0259441a3c8d89e076785cfe03f3bf16e88adf91395d31257b1f2e.png" />
</div>
</div>
</section>
<section id="wet-bulb-temperature">
<h3>3. Wet Bulb Temperature<a class="headerlink" href="#wet-bulb-temperature" title="Link to this heading">#</a></h3>
<p>For an unsaturated parcel with a given <span class="math notranslate nohighlight">\(r_v\)</span>, <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(p\)</span>, the wet-bulb temperature <span class="math notranslate nohighlight">\(T_w\)</span> can be reached by continuously supplying it with liquid water. Since the parcel is unsaturated, the liquid water will evaporate. In an adiabatic setting, the latent heat required to achieve this evaporation must come from the parcel itself, so it will cool down. Eventually, this cooling will saturate the parcel; at this point, it has the wet-bulb temperature. Hence, <span class="math notranslate nohighlight">\(T_w\)</span> can be interpreted as something like the capacity of an air parcel to cool by evaporating liquid water in it. This is super relevant to human thermal comfort, since we cool ourselves this way, and to rain, which when falling into unsaturated air under cloud base will tend to evaporatively cool the air towards <span class="math notranslate nohighlight">\(T_w\)</span>.</p>
<p>For an air parcel from the sounding at 1000 hPa, <span class="math notranslate nohighlight">\(T_w\)</span> can be measured on a SkewT-logP diagram as follows:</p>
<ol class="arabic simple">
<li><p>Draw a mixing ratio line through the 1000 hPa dew point.</p></li>
<li><p>Draw a dry adiabat through the 1000 hPa temperature.</p></li>
<li><p>The intersection of these lines is the LCL. Draw a moist adiabat through the LCL back down to 1000 hPa.</p></li>
</ol>
<p>Here, that gives us a wet-bulb temperature of 17.35°C. There also exists a wet-bulb <em>potential</em> temperature <span class="math notranslate nohighlight">\(\theta_w\)</span>, for which one in step 3 traces the parcel down all the way to the reference pressure of 1000 hPa. In this example, the wet-bulb potential temperature is the same as the wet-bulb temperature, since the pressure level of interest <em>is</em> at 1000hPa.</p>
<p>Why do we have to do this lifting to the LCL and moving back down to find <span class="math notranslate nohighlight">\(T_w\)</span>? The LCL does not appear in the definition of <span class="math notranslate nohighlight">\(T_w\)</span> at all? This comes from our requirement that the parcel stays adiabatic. In such a setting, expanding an unsaturated parcel to a lower pressure is the only way to make it reach saturation (which happens at the LCL). To then adiabatically keep the parcel <em>at</em> saturation, we move it down a moist adiabat (remember, it is also sometimes called a saturated adiabat). But because the parcel itself is not saturated when moving down from the LCL, to keep it on the saturated adiabat, we must add liquid water to the parcel, evaporate it and thus cool it.</p>
<p>In fact, once you have found <span class="math notranslate nohighlight">\(T_w\)</span>, you can read off the amount of liquid water that must be added to a parcel to cool it there, by reading off the mixing ratio of the initial parcel (see <a class="reference internal" href="#sec-mixing-ratio"><span class="std std-ref">the mixing ratio section</span></a>), and the mixing ratio at <span class="math notranslate nohighlight">\(T_w\)</span>: The difference is what must have been supplied as liquid water to bring the parcel to saturation at <span class="math notranslate nohighlight">\(T_w\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">dry_adiabat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Calculate wet-bulb temperature at the surface (1000 hPa)</span>
<span class="n">wet_bulb</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">wet_bulb_temperature</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>  <span class="c1"># Surface pressure</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>                 <span class="c1"># Surface temperature</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>               <span class="c1"># Surface dewpoint temperature</span>
<span class="p">)</span>

<span class="c1"># Print the wet-bulb temperature</span>
<span class="n">wet_bulb_celsius</span> <span class="o">=</span> <span class="n">wet_bulb</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">wet_bulb_celsius</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 4: Calculate the LCL (Lifted Condensation Level)</span>
<span class="n">lcl_pressure</span><span class="p">,</span> <span class="n">lcl_temperature</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>  <span class="c1"># Surface pressure</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>                 <span class="c1"># Surface temperature</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>               <span class="c1"># Surface dewpoint temperature</span>
<span class="p">)</span>

<span class="c1"># Calculate the moist adiabat from the LCL to the surface</span>
<span class="n">moist_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">moist_lapse</span><span class="p">(</span>
    <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lcl_pressure</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">100</span><span class="p">),</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
    <span class="n">lcl_temperature</span>
<span class="p">)</span>

<span class="c1"># Plot the moist adiabat from the LCL to the surface</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">lcl_pressure</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">(),</span> <span class="mi">100</span><span class="p">),</span>
    <span class="n">moist_adiabat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span>
    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span>
<span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1020</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/ce623013d916922c18fd4e32b122343fa4b17baeccebfe0391b15c6e5fbd7841.png" src="_images/ce623013d916922c18fd4e32b122343fa4b17baeccebfe0391b15c6e5fbd7841.png" />
</div>
</div>
</section>
</section>
<section id="stability-and-convection">
<span id="sec-stability"></span><h2>Stability and convection<a class="headerlink" href="#stability-and-convection" title="Link to this heading">#</a></h2>
<section id="diagnosing-stability-of-layers">
<h3>1. Diagnosing stability of layers<a class="headerlink" href="#diagnosing-stability-of-layers" title="Link to this heading">#</a></h3>
<p>Generally speaking, we expect convection (dry or moist) to occur when parcels become positively buoyant with respect to their environment. In the skewT-logP diagrams we analyse in this course, we diagnose positive buoyancy when the actual temperature of a parcel is warmer than that of the atmosphere. We should keep in mind that when the air is moist, we should really use the virtual temperature, but this introduces some complications in reading the diagrams, so we’ll ignore it here. So to judge the “stability” of air layers, we ask ourselves: If we adiabatically lift a parcel from the atmospheric sounding upwards a tiny bit, will it still be warmer than the environment? To judge if this is the case, we must identify the parcel’s lapse rate if we lift it dry adiabatically (<span class="math notranslate nohighlight">\(\Gamma_d\)</span>) or moist adiabatically (<span class="math notranslate nohighlight">\(\Gamma_m\)</span>), and compare these lapse rates to that of the sounding (<span class="math notranslate nohighlight">\(\Gamma\)</span>). As discussed in <a class="reference internal" href="3.%20Thermodynamics%20%28ii%29.html"><span class="std std-doc">Thermodyanmics (ii)</span></a>, because <span class="math notranslate nohighlight">\(\Gamma = -dT/dz\)</span>, a <em>larger</em> value of <span class="math notranslate nohighlight">\(\Gamma\)</span> indicates a more <em>rapid</em> dropoff of temperature with height, so a sounding with a larger <em>Gamma</em> is more unstable. Additionally, since dry adiabatic lifting cools the parcel down more than moist adiabatic lifting (where there is latent heat release warming the parcel), the temperature drops off with height more rapidly along a dry adiabat than a moist adiabat, i.e. <span class="math notranslate nohighlight">\(\Gamma_d \geq \Gamma_m\)</span>.</p>
<p>So there can be three scenarios for the parcel:</p>
<ol class="arabic simple">
<li><p>Absolutely Stable: When lifting a parcel moist adiabatically and dry adiabatically, they always remain colder than their environment and are negatively buoyant. Put differently, the temperature dropoff with height of the parcel (<span class="math notranslate nohighlight">\(\Gamma_d\)</span>, <span class="math notranslate nohighlight">\(\Gamma_m\)</span>) is always larger than that of the environment <span class="math notranslate nohighlight">\(\Gamma\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\Gamma_d &gt; \Gamma
\]</div>
<div class="math notranslate nohighlight">
\[
\Gamma_m &gt; \Gamma
\]</div>
<ol class="arabic simple" start="2">
<li><p>Absolutely Unstable: When lifting a parcel moist adiabatically and dry adiabatically, they are always warmer than their environment and thus positively buoyant. Put differently, the temperature dropoff with height of the parcel (<span class="math notranslate nohighlight">\(\Gamma_d\)</span>, <span class="math notranslate nohighlight">\(\Gamma_m\)</span>) is always smaller than that of the environment <span class="math notranslate nohighlight">\(\Gamma\)</span>:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\Gamma_d &lt; \Gamma
\]</div>
<div class="math notranslate nohighlight">
\[
\Gamma_m &lt; \Gamma
\]</div>
<ol class="arabic simple" start="3">
<li><p>Conditionally Unstable: When lifting a parcel dry adiabatically, it is colder than the environment and thus negatively buoyant, i.e. the temperature dropoff with height of the parcel (<span class="math notranslate nohighlight">\(\Gamma_d\)</span>) is larger than that of the environment <span class="math notranslate nohighlight">\(\Gamma\)</span>. However, when lifting a parcel moist adiabatically, it is <em>warmer</em> than the environment and thus positively buoyant, i.e. the temperature dropoff with height of the parcel (<span class="math notranslate nohighlight">\(\Gamma_m\)</span>) is <em>smaller</em> than that of the environment <span class="math notranslate nohighlight">\(\Gamma\)</span> (i.e. the parcel is unstable, on the <em>condition</em> that it is saturated):</p></li>
</ol>
<div class="math notranslate nohighlight">
\[
\Gamma_d &lt; \Gamma
\]</div>
<div class="math notranslate nohighlight">
\[
\Gamma_m &gt; \Gamma
\]</div>
<p>On a skewT-logP diagram, we can use these conditions to find out which layers in a sounding are stable, unstable or conditionally stable:</p>
<ol class="arabic simple">
<li><p>In the blue region, lifting a parcel along either a dry or a moist adiabat from any point in this layer would make it colder than the sounding temperature, i.e. the layer is stable</p></li>
<li><p>In the red region, lifting a parcel along either a dry or a moist adiabat from any point in this layer would make it warmer than the sounding temperature, i.e. the layer is unstable</p></li>
<li><p>In the yellow region, lifting a parcel along the dry adiabat would make it colder than the environment, but lifting it along a moist adiabat would make it warmer, i.e. the layer is conditionally unstable</p></li>
</ol>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Given points (temperature in degrees Celsius, pressure in hPa)</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">800</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">600</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">33</span><span class="p">,</span> <span class="mi">400</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">53</span><span class="p">,</span> <span class="mi">250</span><span class="p">)]</span>

<span class="c1"># Extract temperature and pressure values</span>
<span class="n">temperatures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">])</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">point</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">points</span><span class="p">])</span>

<span class="c1"># Highlight the regions</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&lt;=</span> <span class="mi">600</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&gt;=</span> <span class="mi">400</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&lt;=</span> <span class="mi">800</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&gt;=</span> <span class="mi">600</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;pink&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">fill_betweenx</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&lt;=</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">&gt;=</span> <span class="mi">800</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightblue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="c1"># Add a label to indicate instability in the highlighted region</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">910</span><span class="p">,</span> <span class="s1">&#39;1. Stable&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="s1">&#39;2. Unstable&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;3. Conditionally Unstable&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>

<span class="c1"># Plot the sounding</span>
<span class="n">_</span><span class="o">=</span><span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">temperatures</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/e416431c5cdb137e3f65e84fc4283cc72ed450bb41b75daef4bb48fbca2f2a9f.png" src="_images/e416431c5cdb137e3f65e84fc4283cc72ed450bb41b75daef4bb48fbca2f2a9f.png" />
</div>
</div>
<p>Unstable layers can be formed by:</p>
<ul class="simple">
<li><p>Heating a layer from below: For instance, the surface layer of the daytime boundary layer is often unstable, since it is warmed from below, and this drives both the dry convective overturning in the boundary layer, and keeps the temperature profile of that layer close to the dry adiabat. You can often recognise the sounding of a daytime boundary layer by looking for these features.</p></li>
<li><p>Cooling a air layer from above: For instance, the ocean surface temperature is often rather constant throughout a daily cycle, since the ocean’s heat capacity is very large. However, at night, the overlying atmosphere cools, since it emits longwave radiation to space, but does not absorb shortwave radiation from the sun. This means that the surface layer will become increasingly unstable. Indeed, more convection is usually triggered over the ocean towards the end of the night.</p></li>
<li><p>Saturating a conditionally unstable layer. This could happen if one  mechanically forces moist or cold air parcels upwards into such a layer. Alternatively, it occurs when air parcels rising through an unstable layer (e.g. near the surface) develop some vertical momentum. If that momentum is large enough to carry them to their LCL in the conditionally unstable layer above, they become unstable and develop vertically. Cumulus clouds often form this way.</p></li>
</ul>
<p>Many severe weather prediction practitioners rely on analyzing skewT-logP diagrams, because they can quickly give you a feeling for the potential of moist convective parcels to destabilise and rise to the tropopause, i.e. to form thunderstorms. Such “convective clouds” can be characterised in several ways, and we will cover them next.</p>
</section>
<section id="level-of-free-convection-lfc-equilibrium-level-el">
<h3>2. Level of Free Convection (LFC) &amp; Equilibrium Level (EL)<a class="headerlink" href="#level-of-free-convection-lfc-equilibrium-level-el" title="Link to this heading">#</a></h3>
<p>First, the “level of free convection” (LFC) is the level where a parcel lifted along a moist adiabat, attains a temperature which exceeds the environmental temperature, and becomes positively buoyant (or free to convect, if you will). This level must thus lie above the LCL. The equilibrium Level (EL) is then the next level at which the positively buoyant parcel becomes negatively buoyant again, i.e. it is the simplest possible model for the top of convective clouds.</p>
<p>To find it on a Skew-T Log-P Diagram, for the 1000 hPa parcel:</p>
<ol class="arabic simple">
<li><p>Draw a mixing ratio line through the surface dew point.</p></li>
<li><p>Draw a dry adiabat through the surface temperature.</p></li>
<li><p>The intersection of these lines is the LCL.</p></li>
<li><p>Draw a moist adiabat through the LCL.</p></li>
</ol>
<p>Now:</p>
<ul class="simple">
<li><p>The LFC is the first intersection of the moist adiabat and the temperature sounding.</p></li>
<li><p>The EL is the first intersection of the moist adiabat and the temperature sounding above the LFC.</p></li>
</ul>
<p>The LFC and EL do not always exist: When moving along a moist adiabat from the LCL, there is no guarantee that a parcel will ever be warmer than the environment, and thus that convective clouds are likely to form from the lifted parcel.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">dry_adiabat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Find LCL</span>
<span class="n">lcl</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">prof</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">parcel_profile</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                             <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                             <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LCL&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;LCL&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Plot parcel</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>


<span class="c1"># Step 4: Calculate LFC</span>
<span class="n">lfc_pressure</span><span class="p">,</span> <span class="n">lfc_temperature</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lfc</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot LFC point</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lfc_temperature</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">lfc_pressure</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;LFC&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">775</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;LFC&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Step 5: Calculate EL</span>
<span class="n">el_pressure</span><span class="p">,</span> <span class="n">el_temperature</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">el</span><span class="p">(</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
    <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1"># Plot EL point</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">el_temperature</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">el_pressure</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
            <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EL&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">36</span><span class="p">,</span> <span class="mi">335</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;EL&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Add legend</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/554153fdc1383617ebb91597f990c35762b9d2065b5b60cd5f4ca24eb1be3697.png" src="_images/554153fdc1383617ebb91597f990c35762b9d2065b5b60cd5f4ca24eb1be3697.png" />
</div>
</div>
</section>
<section id="convective-inhibition-cin-and-convective-available-potential-energy-cape">
<h3>3. Convective Inhibition (CIN) and Convective Available Potential Energy (CAPE)<a class="headerlink" href="#convective-inhibition-cin-and-convective-available-potential-energy-cape" title="Link to this heading">#</a></h3>
<p>When a layer is stable, this does not mean that parcels can’t rise through it at all. For example, parcels may be forced upward by an object (a mountain) or by other amtospheric dynamics. Is is thus often reasonable to ask: How much vertical kinetic energy do we need to give a parcel that is negatively buoyant over a layer, for it to still reach the layer top? For parcels that move adiabatically, the answer to this question is called the “Convective Inhibition” (CIN): The potential energy needed to overcome the negative buoyancy work done by the environment on the parcel. CIN is therefore defined by vertically integrating the buoyancy over the negatively buoyant layer, e.g. between <span class="math notranslate nohighlight">\(z_{\text{bot}}\)</span> and <span class="math notranslate nohighlight">\(z_{\text{top}}\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\text{CIN} = \int_{z_{\text{bot}}}^{z_{\text{top}}} g\left(\frac{T_{\text{parcel}} - T_{\text{env}}}{T_{\text{env}}}\right)dz
\]</div>
<p>So, on a skewT-logP diagram, the CIN is proportional to the area between the lifted parcel (along dry or moist adiabats), over the layer where <span class="math notranslate nohighlight">\(T_{\text{parcel}}\)</span> lies to the left of <span class="math notranslate nohighlight">\(T_{\text{env}}\)</span>. In the sounding we’ve been analysing, the surface parcel is indeed immediately negatively buoyant, up to its LFC. So, to indicate the CIN for this layer in the skewT-logP diagram, we first lift the parcel adiabatically from the surface as in the preceding example (steps 1-3), and then we shade the area between the surface and the LFC. CIN is thus a negative number.</p>
<p>Multiple layers in the sounding might have CIN. For instance, it would be fair to characterise the upper part of the sounding (above the tropopause) as an area of very large CIN. This is often not done, because the CIN is so large that convective weather hardly ever happens in the stratosphere, and we thus rather ignore it.</p>
<p>Conversely, one might ask: <em>If</em> a parcel reaches its LFC, how much positively buoyant energy is there that potentially could be converted into vertical kinetic energy, before it reaches the EL? The answer to this question is called the Convective Available Potential Energy (CAPE). It is the complement of CIN, if <span class="math notranslate nohighlight">\(z_{\text{bot}}\)</span> is the LFC and <span class="math notranslate nohighlight">\(z_{\text{top}}\)</span> is the EL:</p>
<div class="math notranslate nohighlight">
\[
\text{CAPE} = \int_{z_{\text{LFC}}}^{z_{\text{EL}}} g\left(\frac{T_{\text{parcel}} - T_{\text{env}}}{T_{\text{env}}}\right)dz
\]</div>
<p>On a skewT-logP chart, CAPE is thus proportional to the area between the moist adiabat and the temperature sounding between the LFC and the EL. It is a <em>positive</em> number. If convective parcels at the LFC have zero vertical motion, CAPE also tells us the maximum rise speed the parcel can attain, if all this buoyant potential energy were converted into kinetic energy:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}w_{max}^2 = \text{CAPE}
\]</div>
<p>Because of its simplicitly, CAPE is perhaps the most commonly used indicator for the potential of thunderstorm development. In this sounding for example, which is from a few hours before a devastating rainfall event over Valencia on 29 October 2024, there is quite some CAPE. But would the surface warm just a little, there would be an enormous amount of CAPE. We will investigate such sensitivites next.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Plot the dry adiabat line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">dry_adiabat</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 2: Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Find LCL</span>
<span class="n">lcl</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">prof</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">parcel_profile</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                             <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                             <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="c1"># Plot parcel for CAPE &amp; CIN</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">shade_cape</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>

<span class="n">skew</span><span class="o">.</span><span class="n">shade_cin</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span>
                <span class="p">(</span><span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>

<span class="c1"># Label the CAPE and CIN</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;CAPE&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;CIN&#39;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">18</span><span class="p">,</span> <span class="mi">640</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;olive&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/f56ddde595918039658b1aecebc0c530d7bdff1d463d6128a2ad8b0a6fc3c5ce.png" src="_images/f56ddde595918039658b1aecebc0c530d7bdff1d463d6128a2ad8b0a6fc3c5ce.png" />
</div>
</div>
</section>
<section id="convective-condensation-level">
<h3>4. Convective condensation level<a class="headerlink" href="#convective-condensation-level" title="Link to this heading">#</a></h3>
<p>Many problems of forecasting convective clouds involve posing “what if” scenarios. So, instead of lifting the surface parcel, one could ask “how much does this surface parcel have to warm, for convective clouds to spontaneously form”? Over land, we might ask such a question given a morning sounding, expecting the near-surface layer to warm in the coming hours. Therefore, when assessing the risk for thunderstorms, it is often useful to test how much warmer one would have to make the surface parcel, to make it spontaneously reach an LFC. This temperature is called the “convective temperature” <span class="math notranslate nohighlight">\(T_c\)</span> – i.e. it is the surface temperature at which adiabatic parcels are positively buoyant all the way up to the LFC (and therefore all the way to the EL), while keeping the surface dew-point fixed.(often, the surface dew-point also does not change so much during the first hours of a day). The corresponding pressure level at which the convective cloud base is then predicted is called the “convective condensation level” (CCL). To find <span class="math notranslate nohighlight">\(T_c\)</span> and the CCL:</p>
<ol class="arabic simple">
<li><p>Draw a mixing ratio line through the surface dew point. If you want the dew-point to be more representative of the lower atmosphere, rather than just the surface, you can draw it at an average of the dew-point over the lower 100 hPa.</p></li>
<li><p>Find the combination of a dry and moist adiabat that intersect the mixing ratio line such that the parcel temperature is always warmer than the temperature sounding. This may take some trial and error. At the level of the intersection, you can read off the CCL; the lifted parcel’s surface temperature is <span class="math notranslate nohighlight">\(T_c\)</span>.</p></li>
</ol>
<p>Here, <span class="math notranslate nohighlight">\(T_c=25^{\text{o}}C\)</span>, an entirely reacheable value if the sounding’s surface temperature (<span class="math notranslate nohighlight">\(20^{\text{o}}C\)</span>) is measured in the morning.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Step 1: Get the temperature at 1000 hPa and convert to °C</span>
<span class="n">temp_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="c1"># Define the pressure levels for the dry adiabat (same as your dataset&#39;s pressure levels)</span>
<span class="n">pressure_levels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>

<span class="c1"># Calculate the dry adiabat starting from the temperature at 1000 hPa</span>
<span class="n">dry_adiabat</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">temp_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">),</span> 
                               <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="c1"># Calculate the mixing ratio at 1000 hPa using the dew point temperature</span>
<span class="n">dewpoint_1000</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="mf">273.15</span>  <span class="c1"># Convert from K to °C</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">dewpoint_1000</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Saturation vapor pressure</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">))</span>  <span class="c1"># Mixing ratio at 1000 hPa</span>

<span class="c1"># Calculate the dew point temperature at each pressure level for the constant mixing ratio line</span>
<span class="n">constant_mixing_ratio_line</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pressure_levels</span><span class="p">:</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">mixing_ratio</span><span class="p">)</span>  <span class="c1"># Vapor pressure at pressure level p</span>
    <span class="n">dewpoint</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>  <span class="c1"># Dew point temperature at pressure level p</span>
    <span class="n">constant_mixing_ratio_line</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dewpoint</span><span class="o">.</span><span class="n">m_as</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot the constant mixing ratio line</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressure_levels</span><span class="p">,</span> <span class="n">constant_mixing_ratio_line</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Step 3: Find CCL</span>
<span class="n">lcl</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                 <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                 <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">850</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;CCL = </span><span class="si">{</span><span class="n">lcl</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">prof</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">parcel_profile</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                             <span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                             <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>

<span class="c1"># Plot parcel</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;$T_c$ = </span><span class="si">{</span><span class="n">prof</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mf">273.15</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> C&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="c1"># Steps labeling </span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">480</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">17</span><span class="p">,</span> <span class="mi">450</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">900</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/f602f70ae59ba8474524de199451c517f6bcee391f69f4ae4fb0faf13eb5c622.png" src="_images/f602f70ae59ba8474524de199451c517f6bcee391f69f4ae4fb0faf13eb5c622.png" />
</div>
</div>
</section>
</section>
<section id="lifting-followed-by-latent-heat-release-and-descent">
<span id="sec-ascent-descent"></span><h2>Lifting followed by latent heat release and descent<a class="headerlink" href="#lifting-followed-by-latent-heat-release-and-descent" title="Link to this heading">#</a></h2>
<p>Many meteorological analyses consist of subsequently carrying out several operations, and analysing the result. A famous example is lifting an air mass over a mountain.</p>
<p>Let us assume that the parcel at 600 hPa encounters a mountain, and is forced to ascend adiabatically to 400 hPa. It will then follow trajectory 1 in the skewT-logP plot below, i.e. the parcel becomes cloudy at the LCL around 650 hPa, and rises to 400 hPa along the moist adiabat.</p>
<p>As we discussed in the <a class="reference internal" href="#subsec-equiv-pot"><span class="std std-ref">equivalent potential temperature section</span></a>, we can calculate the condesate this has produced, by drawing isohumes through the initial and final dew-points of the lifting (remember that at 400 hPa, the dew-point and temperature are the same, since the parcel is kept at saturation). We have drawn these lines on the diagram below (marked with a “2”), giving <span class="math notranslate nohighlight">\(2.7 - 0.7 = 2\)</span> g/kg of condensated water vapour.</p>
<p>Let us now assume that a portion of this condensated water grows into raindroplets and falls out of the parcel, e.g. 25% of it. That would mean that <span class="math notranslate nohighlight">\(2 \times 0.25 = 0.5\)</span> g/kg of rain is removed from the parcel, and that of the original <span class="math notranslate nohighlight">\(2.7\)</span> g/kg of <em>total</em> water originally in the parcel, now only <span class="math notranslate nohighlight">\(2.2\)</span> g/kg remains: <span class="math notranslate nohighlight">\(0.7\)</span> g/kg of water vapour (read off from the isohume), and <span class="math notranslate nohighlight">\(1.5\)</span> g/kg of condensate.</p>
<p>The parcel now descends back down the mountain on the other side; let us assume it stops at the same 600 hPa level we started from. What will its final temperature be? To figure this out, the key step is to realise that the <em>total</em> water mixing ratio of the parcel has reduced from <span class="math notranslate nohighlight">\(2.7\)</span> g/kg to <span class="math notranslate nohighlight">\(2.2\)</span> g/kg. So when moving the parcel back down the moist adiabat on the skewT-logP diagram, and gradually converting the condensated water back into water vapour, it will encounter a <em>new</em> LCL, at the isohume equal to <span class="math notranslate nohighlight">\(2.2\)</span> g/kg (point “3” on the diagram below): When this new isohume intersects the saturated adiabat we have been moving the parcel along, we know that the <span class="math notranslate nohighlight">\(2.2\)</span> g/kg mixing ratio measured by the new isohume is equal to the saturation mixing ratio of the parcel, i.e. all the condensate has been converted back into water vapour.</p>
<p>From this new LCL, the parcel will descend back down along a dry adiabat, as marked by lines 4. We can now see the consequence of our journey over the mountain: The parcel is both drier (by the amount we have already calculated) and <em>warmer</em> than it originally was: -4.7<span class="math notranslate nohighlight">\(^{o}\)</span>C vs -5.9<span class="math notranslate nohighlight">\(^{o}\)</span>C. Take a moment to appreciate this second fact: We released latent heat when moving the parcel up, but before moving it back down, we removed some of the liquid water that caused this heating. Therefore, a smaller amount of liquid water evaporated on the way down than condensated on the way up, and there was a <em>net</em> latent heating of the parcel of 1.2<span class="math notranslate nohighlight">\(^{o}\)</span>C.</p>
<p>This example illustrates why flows down the leeside of mountains tend to be warm and dry: Föhn winds are a famous example of these “rain shadow” winds. But it also describes the general effect that precipitating clouds have on climate: By condensating water vapour and raining it out at the surface, they “leave behind” a net warming of the atmosphere. We will study this in more depth in the climate modules.</p>
<div class="cell tag_hide-input docutils container">
<details class="admonition hide above-input">
<summary aria-label="Toggle hidden content">
<p class="collapsed admonition-title">Show code cell source</p>
<p class="expanded admonition-title">Hide code cell source</p>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Make the plot</span>
<span class="n">skew</span> <span class="o">=</span> <span class="n">plot_basic_skewt</span><span class="p">()</span>

<span class="c1"># Plot sounding</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">t</span><span class="o">-</span><span class="mf">273.15</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">tdew</span><span class="o">-</span><span class="mf">273.65</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;dew-point temp.&#39;</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">p0</span> <span class="o">=</span> <span class="mi">600</span>
<span class="n">pe</span> <span class="o">=</span> <span class="mi">400</span>

<span class="n">dspl</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">pressure_level</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span><span class="n">pe</span><span class="p">))</span>

<span class="c1"># Lift parcel adiabatically from lowest to highest level in dspl</span>
<span class="n">tprof</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">parcel_profile</span><span class="p">(</span><span class="n">dspl</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> 
                              <span class="n">dspl</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                              <span class="n">dspl</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
<span class="n">plcl</span><span class="p">,</span> <span class="n">tlcl</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">lcl</span><span class="p">(</span><span class="n">dspl</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span>
                        <span class="n">dspl</span><span class="o">.</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">),</span>
                        <span class="n">dspl</span><span class="o">.</span><span class="n">tdew</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span>

<span class="n">dewpoint</span> <span class="o">=</span> <span class="p">(</span><span class="n">dspl</span><span class="o">.</span><span class="n">tdew</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span> <span class="c1"># Convert to °C</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">dewpoint</span><span class="p">)</span>
<span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">dspl</span><span class="o">.</span><span class="n">pressure_level</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">))</span>

<span class="n">isohume</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">pisohume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">dspl</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">plcl</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">pisohume</span><span class="p">:</span>
    <span class="n">isohume</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">mixing_ratio</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span><span class="o">.</span><span class="n">metpy</span><span class="o">.</span><span class="n">convert_units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">))</span>  <span class="c1"># Convert to °C</span>

<span class="c1"># Plot parcel</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dspl</span><span class="o">.</span><span class="n">pressure_level</span><span class="p">,</span> <span class="n">tprof</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pisohume</span><span class="p">,</span> <span class="n">isohume</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plcl</span><span class="p">,</span> <span class="n">tlcl</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">)</span>

<span class="c1"># Now add an isohumes to top and bottom level of the rising parcel, and to the new LCL point</span>
<span class="c1"># Isohume going from 1000 hPa through a prescribed combination of T and p</span>
<span class="c1"># These must have units degC and hPa</span>
<span class="k">def</span><span class="w"> </span><span class="nf">isohume</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-.&#39;</span><span class="p">):</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">saturation_vapor_pressure</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">mixing_ratio</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">mixing_ratio</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">pisohume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">p0</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">p</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">isohume</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pisohume</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pisohume</span><span class="p">)):</span>
        <span class="n">isohume</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dewpoint</span><span class="p">(</span><span class="n">mpcalc</span><span class="o">.</span><span class="n">vapor_pressure</span><span class="p">(</span><span class="n">pisohume</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">mixing_ratio</span><span class="p">))</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pisohume</span><span class="p">,</span> <span class="n">isohume</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">skew</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">magnitude</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mixing_ratio</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;g/kg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

<span class="n">isohume</span><span class="p">(</span><span class="n">dewpoint</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">p0</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">skew</span><span class="p">)</span>
<span class="n">isohume</span><span class="p">(</span><span class="n">tprof</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">),</span> <span class="n">pe</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">skew</span><span class="p">)</span>

<span class="c1"># T and p combo that matches the rainfall calculation in the text</span>
<span class="n">tlcl2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">15.5</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>
<span class="n">plcl2</span> <span class="o">=</span> <span class="mi">520</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">)</span>
<span class="n">isohume</span><span class="p">(</span><span class="n">tlcl2</span><span class="p">,</span> <span class="n">plcl2</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">)</span>

<span class="c1"># dry adiabat down to p0</span>
<span class="n">pressures</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">p0</span> <span class="o">*</span> <span class="n">units</span><span class="p">(</span><span class="s1">&#39;hPa&#39;</span><span class="p">),</span> <span class="n">plcl2</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">mpcalc</span><span class="o">.</span><span class="n">dry_lapse</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">tlcl2</span><span class="p">,</span> <span class="n">reference_pressure</span><span class="o">=</span><span class="n">plcl2</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;degC&#39;</span><span class="p">)</span>

<span class="c1"># Plot new parcel</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">tlcl2</span><span class="p">,</span> <span class="n">plcl2</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">skew</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">ts</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">isohume</span><span class="p">(</span><span class="n">tlcl2</span><span class="p">,</span> <span class="n">plcl2</span><span class="p">,</span> <span class="n">skew</span><span class="p">,</span> <span class="n">p0</span><span class="o">=</span><span class="n">p0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">34</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="s1">&#39;1&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;darkblue&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">21</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;2&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="s1">&#39;3&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;brown&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
<span class="n">_</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">550</span><span class="p">,</span> <span class="s1">&#39;4&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
         <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;circle&#39;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/2507f5ca3dcf4bb42d349a759500276a4e09f423e4f8a657dbe0a526cdcc22ce.png" src="_images/2507f5ca3dcf4bb42d349a759500276a4e09f423e4f8a657dbe0a526cdcc22ce.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "metclim-book-env"
        },
        kernelOptions: {
            name: "metclim-book-env",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'metclim-book-env'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="3.%20Thermodynamics%20%28ii%29.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">3. Thermodynamics (ii) - Moist thermodynamics</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-lines-in-the-skew-t-log-p-diagram">The lines in the Skew T-log P diagram</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sec-meteo-variables">Identifying meteorological variables</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">1. Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dew-point-temperature">2. Dew Point Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#potential-temperature">3. Potential Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mixing-ratio">4. Mixing Ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#saturation-mixing-ratio">5. Saturation mixing ratio</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relative-humidity-rh">6. Relative Humidity (RH)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#moist-adiabatic-parcels-simple-clouds">Moist-adiabatic parcels: Simple clouds</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lifting-condensation-level-lcl">1. Lifting Condensation Level (LCL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#equivalent-potential-temperature-and-condensated-water-vapour">2. Equivalent potential temperature and condensated water vapour</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wet-bulb-temperature">3. Wet Bulb Temperature</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stability-and-convection">Stability and convection</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnosing-stability-of-layers">1. Diagnosing stability of layers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#level-of-free-convection-lfc-equilibrium-level-el">2. Level of Free Convection (LFC) &amp; Equilibrium Level (EL)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convective-inhibition-cin-and-convective-available-potential-energy-cape">3. Convective Inhibition (CIN) and Convective Available Potential Energy (CAPE)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convective-condensation-level">4. Convective condensation level</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lifting-followed-by-latent-heat-release-and-descent">Lifting followed by latent heat release and descent</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Martin Janssens
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>