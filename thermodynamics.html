
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Thermodynamics (I and II) &#8212; Lecture notes - Meteorology &amp; Climate</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'thermodynamics';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Welcome to Meteorology &amp; Climate" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
  
    <p class="title logo__title">Lecture notes - Meteorology & Climate</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Welcome to Meteorology & Climate
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Thermodynamics (I and II)</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fthermodynamics.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/thermodynamics.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Thermodynamics (I and II)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gases-the-kinetic-theory">Ideal gases - the kinetic theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure">Pressure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gas-law">The gas law</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gases-of-mixed-composition">Ideal gases of mixed composition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-pressures">Partial pressures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-to-mass">Converting to mass</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#virtual-temperature">Virtual temperature</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="thermodynamics-i-and-ii">
<h1>Thermodynamics (I and II)<a class="headerlink" href="#thermodynamics-i-and-ii" title="Link to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Questions you should be able to answer at the end of this module:</p>
<ul class="simple">
<li><p>Can I derive the ideal gas law from the collective motion of particles?</p></li>
<li><p>How are pressure, density and temperature related, when one of the three is held fixed?</p></li>
<li><p>What is a partial pressure?</p></li>
<li></li>
</ul>
</div>
<section id="ideal-gases-the-kinetic-theory">
<h2>Ideal gases - the kinetic theory<a class="headerlink" href="#ideal-gases-the-kinetic-theory" title="Link to this heading">#</a></h2>
<p>We almost always consider the atmosphere to be an ideal gas (even when cloud, ice and aerosol particles form within it!). What does this mean again? Ideal gases obey the gas law:</p>
<div class="math notranslate nohighlight" id="equation-gaslaw">
<span class="eqno">(1)<a class="headerlink" href="#equation-gaslaw" title="Link to this equation">#</a></span>\[
pV = k_bn_0T
\]</div>
<p>It says that if the gas occupies a volume <span class="math notranslate nohighlight">\(V\)</span>, we can relate easily measured properties of the gas (temperature <span class="math notranslate nohighlight">\(T\)</span>, pressure on <span class="math notranslate nohighlight">\(V\)</span>’s walls <span class="math notranslate nohighlight">\(p\)</span> and the “amount of stuff” in <span class="math notranslate nohighlight">\(V\)</span>, here expressed as number of particles <span class="math notranslate nohighlight">\(n_0\)</span>). Conveniently, this allows us to describe gases without tracking individual atoms and molecules, and we will do so in the rest of the course. But understanding why the gas law holds is actually best understood from considering the forces and energies on the collection of particles in <span class="math notranslate nohighlight">\(V\)</span>.</p>
<section id="temperature">
<h3>Temperature<a class="headerlink" href="#temperature" title="Link to this heading">#</a></h3>
<p>If the distance between particles is much larger than their individual size, and the particles move in random directions with a fixed distribution of speeds, the average kinetic energy of all <span class="math notranslate nohighlight">\(n_0\)</span> particles, each with speed <span class="math notranslate nohighlight">\(u_i\)</span> and average mass <span class="math notranslate nohighlight">\(m_a\)</span><a class="footnote-reference brackets" href="#fnm" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, is:</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}m_a\frac{1}{n_0}\sum_i^{n_0} u_i^2
\]</div>
<p>In the kinetic theory, this average kinetic energy over the <span class="math notranslate nohighlight">\(n_0\)</span> particles expresses itself as temperature <span class="math notranslate nohighlight">\(T\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-tkinetic">
<span class="eqno">(2)<a class="headerlink" href="#equation-tkinetic" title="Link to this equation">#</a></span>\[
T \propto \frac{1}{2}m_a\frac{1}{n_0}\sum_i^{n_0} u_i^2 = \frac{1}{2} m_a v^2,
\]</div>
<p>where <span class="math notranslate nohighlight">\(v\)</span><a class="footnote-reference brackets" href="#fns" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a> is the single speed that all the particles would have to have to give the same kinetic energy.</p>
</section>
<section id="pressure">
<h3>Pressure<a class="headerlink" href="#pressure" title="Link to this heading">#</a></h3>
<p>The particles constantly bounce into each other, and into the walls. Over these collisions:</p>
<ul class="simple">
<li><p>the particles’ kinetic energy must be preserved (else e.g. <span class="math notranslate nohighlight">\(T\)</span> would change without doing anything to the gas!), and</p></li>
<li><p>there must be enough collisions with the wall that the momentum carried by the colliding particles can be measured as a force <span class="math notranslate nohighlight">\(F\)</span>, so pressure <span class="math notranslate nohighlight">\(p=F/A\)</span>.</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\(V\)</span> is a 3D cube with side length <span class="math notranslate nohighlight">\(l\)</span> and 6 sides, the area of one side is <span class="math notranslate nohighlight">\(V/l\)</span>, so:</p>
<div class="math notranslate nohighlight" id="equation-cubearea">
<span class="eqno">(3)<a class="headerlink" href="#equation-cubearea" title="Link to this equation">#</a></span>\[
A=6\frac{V}{l}
\]</div>
<p>For <span class="math notranslate nohighlight">\(n_0\)</span> particles of average mass <span class="math notranslate nohighlight">\(m_a\)</span> and average speed <span class="math notranslate nohighlight">\(v=l/t\)</span> <a class="footnote-reference brackets" href="#fnt" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> move randomly in all three directions, their force on the walls in the <span class="math notranslate nohighlight">\(d\)</span><sup>th</sup> direction is</p>
<div class="math notranslate nohighlight">
\[
F_d = 2n_0m_a\frac{dv}{dt} = 2n_0m_a\frac{d}{dt}\left( \frac{l}{t} \right) = 2n_0m_a \frac{l}{t^2} = \frac{2n_0}{l}m_av^2,
\]</div>
<p>where the factor 2 expresses that the particles can move both forward and backward in that direction, and collide with both walls <a class="footnote-reference brackets" href="#fnw" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>4<span class="fn-bracket">]</span></a>. Because this force is the same in all directions, the pressure on all walls is:</p>
<div class="math notranslate nohighlight" id="equation-cubepressure">
<span class="eqno">(4)<a class="headerlink" href="#equation-cubepressure" title="Link to this equation">#</a></span>\[
p = F/A = F_d/A = \frac{\frac{2n_0}{l}m_av^2}{6\frac{V}{l}} = \frac{1}{3}\frac{n_0}{V}m_av^2
\]</div>
</section>
<section id="the-gas-law">
<h3>The gas law<a class="headerlink" href="#the-gas-law" title="Link to this heading">#</a></h3>
<p>We can now write something that looks a lot like the ideal gas law from eq. <a class="reference internal" href="#equation-cubepressure">(4)</a> by using the observation from eq. <a class="reference internal" href="#equation-tkinetic">(2)</a> <span class="math notranslate nohighlight">\(m_av^2\propto 2T\)</span>, i.e. that temperature is completely explained by the kinetic energy of the particles:</p>
<div class="math notranslate nohighlight">
\[
p \propto \frac{2}{3}\frac{n_0T}{V}
\]</div>
<p>And we can turn it into the gas law exactly by defining the constant <span class="math notranslate nohighlight">\(k_b=1.380649\times 10^{-23}\)</span> J/K <a class="footnote-reference brackets" href="#fnbol" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>5<span class="fn-bracket">]</span></a>, which converts units of temperature into kinetic energy of molecules, so that:</p>
<div class="math notranslate nohighlight" id="equation-gaslaw-derived">
<span class="eqno">(5)<a class="headerlink" href="#equation-gaslaw-derived" title="Link to this equation">#</a></span>\[
p = k_b\frac{n_0T}{V} 
\]</div>
<p>The gas law summarises three important relationships:</p>
<ol class="arabic simple">
<li><p>If <span class="math notranslate nohighlight">\(T=\text{cst}\)</span>, expanding the gas (<span class="math notranslate nohighlight">\(V\uparrow\)</span>) lowers the pressure (<span class="math notranslate nohighlight">\(p\downarrow\)</span>), as the particles with the same kinetic energy have to spread out, and bounce into the larger walls less frequently (Boyle’s law)</p></li>
<li><p>If <span class="math notranslate nohighlight">\(p=\text{cst}\)</span>, raising the temperature (<span class="math notranslate nohighlight">\(T\uparrow\)</span>) requires the volume to increase, to retain the same rate and momentum of particles bouncing of the walls (Charles’ first law)</p></li>
<li><p>If <span class="math notranslate nohighlight">\(V=\text{cst}\)</span>, raising the temperature (<span class="math notranslate nohighlight">\(T\uparrow\)</span>) raises the kinetic energy of the particles, so they bounce into the walls more often and more vigorously, raising the pressure (<span class="math notranslate nohighlight">\(p\uparrow\)</span>) (Charles’ second law).</p></li>
</ol>
</section>
</section>
<section id="ideal-gases-of-mixed-composition">
<h2>Ideal gases of mixed composition<a class="headerlink" href="#ideal-gases-of-mixed-composition" title="Link to this heading">#</a></h2>
<section id="partial-pressures">
<h3>Partial pressures<a class="headerlink" href="#partial-pressures" title="Link to this heading">#</a></h3>
<p>In atmospheric air, <span class="math notranslate nohighlight">\(n_0\)</span> is a composition of many types of molecules:</p>
<div class="math notranslate nohighlight">
\[
n_0 = n_{0_{N_2}} + n_{0_{O_2}} + n_{0_{H_2O}} + ...
\]</div>
<p>Notice that what matters in eq. <a class="reference internal" href="#equation-gaslaw-derived">(5)</a>, is the number of particles bouncing around in <span class="math notranslate nohighlight">\(V\)</span>. The consequence is that pressure can be linearly decomposed into pressure contributions from different gases (called partial pressures), according to how many molecules of that gas there are<a class="footnote-reference brackets" href="#fndal" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>6<span class="fn-bracket">]</span></a>:</p>
<div class="math notranslate nohighlight">
\[
p = k_b\frac{n_0T}{V} = (n_{0_{N_2}} + n_{0_{O_2}} + n_{0_{H_2O}} + ...)\frac{k_bT}{V} = n_{0_{N_2}}\frac{k_bT}{V} + n_{0_{O_2}}\frac{k_bT}{V} + n_{0_{H_2O}}\frac{k_bT}{V} + ... = p_{N_2} + p_{O_2} + p_{H_2O} + ...
\]</div>
<p>Of course, we can choose which decomposition of <span class="math notranslate nohighlight">\(n_0\)</span> is useful, and in atmospheric science, we almost always decompose it into the total number of water molecules <span class="math notranslate nohighlight">\(n_{H_2O}\)</span>, and “everything else”, <span class="math notranslate nohighlight">\(n_d\)</span> (we usually call <span class="math notranslate nohighlight">\(n_d\)</span> dry air).</p>
<div class="math notranslate nohighlight" id="equation-dalton-water">
<span class="eqno">(6)<a class="headerlink" href="#equation-dalton-water" title="Link to this equation">#</a></span>\[
p = (n_d + n_{H_2O})\frac{k_bT}{V}
\]</div>
</section>
<section id="converting-to-mass">
<h3>Converting to mass<a class="headerlink" href="#converting-to-mass" title="Link to this heading">#</a></h3>
<p>Earlier, we argued that it would be useful to have an expression for gases that don’t rely on having to count numbers and speeds of molecules. That gave us expressions for <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(p\)</span> and their relation (eq. <a class="reference internal" href="#equation-gaslaw-derived">(5)</a>), but in eq. <a class="reference internal" href="#equation-dalton-water">(6)</a> we still have <span class="math notranslate nohighlight">\(n_d\)</span> and <span class="math notranslate nohighlight">\(n_{H_2O}\)</span>. In air, it is usually easier to measure masses. For example, the dry air density <span class="math notranslate nohighlight">\(\rho_d\)</span> measures the mass of dry air <span class="math notranslate nohighlight">\(m_d\)</span> in <span class="math notranslate nohighlight">\(V\)</span>: <span class="math notranslate nohighlight">\(\rho_d = m_d/V\)</span>, while for water, <span class="math notranslate nohighlight">\(\rho_{H_2O} = m_{H_2O}/V\)</span>. To convert <span class="math notranslate nohighlight">\(n_d\)</span> to <span class="math notranslate nohighlight">\(m_d\)</span> (or any molecule number to a mass), we need to know how much a particular molecule weighs, which is expressed by the molecular mass <span class="math notranslate nohighlight">\(m_m\)</span> (in kg), i.e.:</p>
<div class="math notranslate nohighlight">
\[
m = n m_m
\]</div>
<p>Because an air volume may contain many versions of the same molecule of different molecular mass (isotopes), often <span class="math notranslate nohighlight">\(m_m\)</span> is reported not for one, but for <span class="math notranslate nohighlight">\(6.022\times 10^{23}\)</span> molecules (equal by definition to Avogadro’s number <span class="math notranslate nohighlight">\(N_A\)</span> and to one mole). That quantity, <span class="math notranslate nohighlight">\(M_m = m_m*N_A\)</span> is called the molar mass (commonly reported in grams per mole). For our conversion, it means:</p>
<div class="math notranslate nohighlight">
\[
m = n \frac{M_m}{N_A}
\]</div>
<p>Such that, for the decomposition chosen in eq. <a class="reference internal" href="#equation-dalton-water">(6)</a>,</p>
<div class="math notranslate nohighlight" id="equation-p-molar">
<span class="eqno">(7)<a class="headerlink" href="#equation-p-molar" title="Link to this equation">#</a></span>\[
p = (\frac{m_d}{N_A M_{m_d}} + \frac{N_A m_{H_2O}}{M_{m_{H_2O}}})\frac{k_bT}{V}
\]</div>
<p>with <span class="math notranslate nohighlight">\(M_{m_d}=28.97\)</span> g/mol <a class="footnote-reference brackets" href="#fndry" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>7<span class="fn-bracket">]</span></a> and <span class="math notranslate nohighlight">\(M_{m_v}=18.016\)</span> g/mol<a class="footnote-reference brackets" href="#fnvap" id="id8" role="doc-noteref"><span class="fn-bracket">[</span>8<span class="fn-bracket">]</span></a>. At this point we usually gather constants, giving the gas constants <span class="math notranslate nohighlight">\(R_d\)</span> and <span class="math notranslate nohighlight">\(R_v\)</span> for dry air and water vapour:</p>
<div class="math notranslate nohighlight">
\[
R_d = \frac{N_A k_b}{M_{m_d}} = 287.05 \text{ J / kg / K}, \quad R_v = \frac{N_A k_b}{M_{m_{v}}} = 461.5 \text{ J / kg / K}
\]</div>
<p>You will see <span class="math notranslate nohighlight">\(R_d\)</span>, <span class="math notranslate nohighlight">\(R_v\)</span> and derivatives of them many times in the future. The key thing to remember about them, is that they can only change between different gases due to differences in the gas’s (molar) mass:</p>
<div class="math notranslate nohighlight">
\[
R_d/R_v = \frac{\frac{N_A k_b}{M_{m_d}}}{\frac{N_A k_b}{M_{m_{v}}}} = \frac{M_{m_{v}}}{M_{m_d}} = \frac{18.016}{28.97} = 0.622 = \varepsilon.
\]</div>
<p>In fact, the fact that water vapour is <span class="math notranslate nohighlight">\(\varepsilon = 0.622\)</span> times lighter than dry air, is the most important reason to choose the decomposition of eq. <a class="reference internal" href="#equation-dalton-water">(6)</a>. Inserting the definitions for <span class="math notranslate nohighlight">\(R_d\)</span> and <span class="math notranslate nohighlight">\(R_v\)</span> in eq. <a class="reference internal" href="#equation-p-molar">(7)</a> and rewriting in terms of densities, then finally gives us a gas law we can practically do atmospheric science with:</p>
<div class="math notranslate nohighlight" id="equation-gaslaw-moist">
<span class="eqno">(8)<a class="headerlink" href="#equation-gaslaw-moist" title="Link to this equation">#</a></span>\[
p = \left(\frac{R_dm_d}{V} + \frac{R_vm_{H_2O}}{V}\right)T = \left(R_d\rho_d + R_v\rho_v\right)T
\]</div>
</section>
<section id="virtual-temperature">
<h3>Virtual temperature<a class="headerlink" href="#virtual-temperature" title="Link to this heading">#</a></h3>
<p>Many atmospheric science problems involve calculating the lightness of air with respect to its surroundings; its buoyancy. Since <span class="math notranslate nohighlight">\(M_{v} = 0.622M_d\)</span>, we cannot ignore the effect of water vapour in these problems <a class="footnote-reference brackets" href="#fnyang" id="id9" role="doc-noteref"><span class="fn-bracket">[</span>9<span class="fn-bracket">]</span></a>. But people like to work with the gas law as if it applied to dry air. To resolve this, it is common to define a temperature that still satisfies the dry gas law, even when the air is moist. Let us do this too. First, we recognise that the total air density <span class="math notranslate nohighlight">\(\rho_t\)</span> in the volume satisfies:</p>
<div class="math notranslate nohighlight">
\[
\rho_t = \frac{m_d+m_v}{V}
\]</div>
<p>If we define the specific humidity <span class="math notranslate nohighlight">\(q_v\)</span> to measure the amount of water vapour (in kg water vapour per kg air):</p>
<div class="math notranslate nohighlight">
\[
q_v = m_v/(m_a + m_v) = \rho_v/\rho_t,
\]</div>
<p>so that <span class="math notranslate nohighlight">\(\rho_v = \rho_t q_v\)</span>, then we can rewrite</p>
<div class="math notranslate nohighlight">
\[
\rho_d = \frac{m_d + m_v - m_v}{V} = \rho_t - \rho_v = \rho_t - q_v\rho_t = \rho_t(1 - q_v).
\]</div>
<p>If we insert this in the gas law eq. <a class="reference internal" href="#equation-gaslaw-moist">(8)</a> and rearrange, we get:</p>
<div class="math notranslate nohighlight" id="equation-gaslaw-virt">
<span class="eqno">(9)<a class="headerlink" href="#equation-gaslaw-virt" title="Link to this equation">#</a></span>\[\begin{split}
p &amp; = \left(R_d \rho_t(1-q_v) + R_v\rho_t q_v\right)T \\
  &amp; = \rho_tR_d\left(1 + q_v\left(\frac{1}{\varepsilon} - 1\right)\right)T
\end{split}\]</div>
<p>From which we define the <em>virtual temperature</em> <span class="math notranslate nohighlight">\(T_v\)</span></p>
<div class="math notranslate nohighlight" id="equation-tvirt">
<span class="eqno">(10)<a class="headerlink" href="#equation-tvirt" title="Link to this equation">#</a></span>\[\begin{split}
  T_v &amp; = T\left(1 + q_v\left(\frac{1}{\varepsilon} - 1\right)\right) \\
      &amp; = T\left(1 + 0.608 q_v\right),
\end{split}\]</div>
<p>so that the gas law for moist air might be expressed as <a class="footnote-reference brackets" href="#fnrho" id="id10" role="doc-noteref"><span class="fn-bracket">[</span>10<span class="fn-bracket">]</span></a>:</p>
<div class="math notranslate nohighlight">
\[
  p = \rho_t R_d T_v \approx \rho_d R_d T_v.
\]</div>
<p>You might now ask: If the gas law only cares about the number of particles bouncing around <span class="math notranslate nohighlight">\(n_0\)</span> (see eq. <a class="reference internal" href="#equation-gaslaw-derived">(5)</a>), why would it matter how light those particles are, and why do we need <span class="math notranslate nohighlight">\(T_v\)</span>? Fundamentally, this comes from our wish to measure atmospheric air properties in mass (<span class="math notranslate nohighlight">\(q_v\)</span> and <span class="math notranslate nohighlight">\(\rho_d\)</span>) rather than in number of molecules (<span class="math notranslate nohighlight">\(n_{d}\)</span>, <span class="math notranslate nohighlight">\(n_{H_2O}\)</span>), and the conversion of the gas law to eq. <a class="reference internal" href="#equation-gaslaw-moist">(8)</a> that was needed to achieve that. The interpretation of <span class="math notranslate nohighlight">\(T_v\)</span> follows from this choice: If we have two identical air volumes with the same number of particles <span class="math notranslate nohighlight">\(n_0\)</span> at the same temperature <span class="math notranslate nohighlight">\(T\)</span>, but one of them consists only of dry air particles and the other contains some water vapour molecules, then, because water vapour is lighter than dry air, we will measure the moist air volume to be lighter than the dry air volume. In other words, <span class="math notranslate nohighlight">\(\rho_t\)</span> is lower in the moist volume than in the dry volume. At the same time, because both volumes have the same <span class="math notranslate nohighlight">\(n_0\)</span>, <span class="math notranslate nohighlight">\(T\)</span> and <span class="math notranslate nohighlight">\(V\)</span>, the gas law demands that they must have the same <span class="math notranslate nohighlight">\(p\)</span>. To achieve this pressure in the moist volume while using <span class="math notranslate nohighlight">\(\rho_t\)</span> as our air density, we must increase <span class="math notranslate nohighlight">\(\rho_t\)</span> by the factor <span class="math notranslate nohighlight">\(1+0.608q_v\)</span> (note that it is always <span class="math notranslate nohighlight">\(\geq 1\)</span>!), as we did in eq. <a class="reference internal" href="#equation-gaslaw-virt">(9)</a>. By using <span class="math notranslate nohighlight">\(T_v\)</span>, we choose to account for this effect not by changing the density (where the difference resides), but by changing the temperature <a class="footnote-reference brackets" href="#fntvirt" id="id11" role="doc-noteref"><span class="fn-bracket">[</span>11<span class="fn-bracket">]</span></a>. This leads to an often-used definition for <span class="math notranslate nohighlight">\(T_v\)</span>: It is the higher temperature that a mass of dry air (with <span class="math notranslate nohighlight">\(\rho_t\)</span> and <span class="math notranslate nohighlight">\(R_d\)</span>) would need to have to compensate for the fact that it is heavier than moist air, to exert the same pressure as that moist air.</p>
<!-- Ideas for exercises:
- How big is the effect of ignoring liquid water loading on the local pressure? (btw, I think we include this effect in DALES??)
- Estimating the error of a GCM that doesn't include water vapour in its buoyancy calculations
- Estimating the warming from the lightness of water vapour.
--><hr class="footnotes docutils" />
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="fnm" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Of course the particles can have different masses, as we will return to in a moment.</p>
</aside>
<aside class="footnote brackets" id="fns" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">2</a><span class="fn-bracket">]</span></span>
<p>More precisely, <span class="math notranslate nohighlight">\(v = \sqrt{\frac{1}{n_0}\sum_i^{n_0} u_i^2}\)</span> is the root-mean-square of <span class="math notranslate nohighlight">\(u_i\)</span>.</p>
</aside>
<aside class="footnote brackets" id="fnt" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">3</a><span class="fn-bracket">]</span></span>
<p><span class="math notranslate nohighlight">\(t\)</span> is then the avreage time before a particle encoutners a boundary.</p>
</aside>
<aside class="footnote brackets" id="fnw" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id4">4</a><span class="fn-bracket">]</span></span>
<p>We have also neglected a minus in differentiating to <span class="math notranslate nohighlight">\(t\)</span>, because we only care about magnitudes.</p>
</aside>
<aside class="footnote brackets" id="fnbol" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id5">5</a><span class="fn-bracket">]</span></span>
<p>Called the Boltzmann constant</p>
</aside>
<aside class="footnote brackets" id="fndal" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id6">6</a><span class="fn-bracket">]</span></span>
<p>This is called Dalton’s law of partial pressures.</p>
</aside>
<aside class="footnote brackets" id="fndry" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">7</a><span class="fn-bracket">]</span></span>
<p>Because dry air is a lumped sum over all <span class="math notranslate nohighlight">\(N\)</span> molecule types in the atmosphere, each with its own molar mass, <span class="math notranslate nohighlight">\(M_d\)</span> is a composite value. It has to satisfy <span class="math notranslate nohighlight">\(m_d = n_d \frac{M_d}{N_A}\)</span>. But, we can also break <span class="math notranslate nohighlight">\(m_d\)</span> down into all its constituents: <span class="math notranslate nohighlight">\(m_d = \sum_i^N n_i m_i=\frac{1}{N_A} \sum_i^N n_i M_i\)</span>, where <span class="math notranslate nohighlight">\(n_i\)</span>, <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(M_i\)</span> are the number molecular mass and molar mass of the i<sup>th</sup> constituents, respectively. Equating these expressions and solving for <span class="math notranslate nohighlight">\(M_d\)</span> gives <span class="math notranslate nohighlight">\(M_d = \frac{\sum_i n_iM_i}{n_d}\)</span>, i.e. it is a number-weighted average of the constituent-specifc molar masses. Hence, if the atmospheric air composition varies, so does <span class="math notranslate nohighlight">\(M_d\)</span>. <span class="math notranslate nohighlight">\(M_d=28.97\)</span> g/mol is thus a value for “standard air”; in this course we consider it constant.</p>
</aside>
<aside class="footnote brackets" id="fnvap" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id8">8</a><span class="fn-bracket">]</span></span>
<p>Here we have assumed that all the water molecules are present in vapour form. This is quite a subtle, but important distinction, because water in vapour form is about 1000 times lighter than water in liquid form (i.e. its molar mass is 1000 times less than of liquid water), and both forms are present in the atmosphere. To emphasise this difference, we continue the development with the symbol <span class="math notranslate nohighlight">\(M_v\)</span> instead of <span class="math notranslate nohighlight">\(M_{H_2O}\)</span>.</p>
</aside>
<aside class="footnote brackets" id="fnyang" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id9">9</a><span class="fn-bracket">]</span></span>
<p>See <a class="reference external" href="https://doi.org/10.1038/s41561-022-01033-x">Yang et al., 2022</a> for a nice recent discussion on the effect of ignoring this effect in global climate models</p>
</aside>
<aside class="footnote brackets" id="fnrho" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id10">10</a><span class="fn-bracket">]</span></span>
<p>For reasons we will touch on later in the course, <span class="math notranslate nohighlight">\(q_v \sim 0-0.03\)</span> kg/kg, so for <span class="math notranslate nohighlight">\(\rho_t\sim 1\)</span> kg/m<span class="math notranslate nohighlight">\(^3\)</span> (like at sea level), making the assumption</p>
<div class="math notranslate nohighlight">
\[
    \rho_t = \rho_d/(1-q_v) \approx \rho_d
    \]</div>
<p>is usually justified.</p>
</aside>
<aside class="footnote brackets" id="fntvirt" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id11">11</a><span class="fn-bracket">]</span></span>
<p>In terms of the kinetic theory, we pretend that when using the dry gas constant for a mass of moist air, thus underestimating the number of particles <span class="math notranslate nohighlight">\(n_0\)</span> we actually have in the volume (because we actually need more light water vapour molecules to produce that mass), we can correct for this effect by giving the fewer particles more kinetic energy. In this sense, using <span class="math notranslate nohighlight">\(T_v\)</span> is a true trick that gives the right ideal gas description, but the wrong molecular-level description.</p>
</aside>
</aside>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: ""
        },
        kernelOptions: {
            name: "",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = ''</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Welcome to Meteorology &amp; Climate</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gases-the-kinetic-theory">Ideal gases - the kinetic theory</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#temperature">Temperature</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#pressure">Pressure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-gas-law">The gas law</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ideal-gases-of-mixed-composition">Ideal gases of mixed composition</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#partial-pressures">Partial pressures</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#converting-to-mass">Converting to mass</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#virtual-temperature">Virtual temperature</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Martin Janssens
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>